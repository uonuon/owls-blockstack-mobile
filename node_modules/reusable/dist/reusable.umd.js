!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e(t.reusable={},t.react)}(this,function(t,e){var n="default"in e?e.default:e,r=function(t){this.subscribers=[],this.cachedValue=null,this.fn=t};r.prototype.getValue=function(){return this.cachedValue},r.prototype.run=function(){return this.cachedValue=this.fn(),this.cachedValue},r.prototype.subscribe=function(t){var e=this;return this.subscribers=this.subscribers.concat([t]),function(){e.subscribers=e.subscribers.filter(function(e){return e!==t})}},r.prototype.notify=function(){var t=this;this.subscribers.forEach(function(e){return e(t.cachedValue)})};var u=function(){this.units=new Map,this.subscribers=[]};u.prototype.onUnitsChanged=function(t){var e=this;return this.subscribers=this.subscribers.concat([t]),function(){return e.subscribers=e.subscribers.filter(function(e){return e!==t})}},u.prototype.createUnit=function(t){if(this.units.has(t))throw new Error("Unit already exist",t);var e=new r(t);this.units.set(t,e),this.notifyUnitsChanged()},u.prototype.getUnit=function(t){if(!this.units.has(t))throw new Error("Unit doesn't exist",t);return this.units.get(t)},u.prototype.notifyUnitsChanged=function(){this.subscribers.forEach(function(t){return t()})},u.prototype.getUnitsArray=function(){var t=[];return this.units.forEach(function(e){t.push(e)}),t};var i=new u,o=function(){return i},s=Object.prototype.hasOwnProperty;function c(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function f(t,e){if(c(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var u=0;u<n.length;u++)if(!s.call(e,n[u])||!c(t[n[u]],e[n[u]]))return!1;return!0}var a=n.createContext(),h=function(t){var n=t.unit;return n.run(),e.useEffect(function(){return n.notify()},[n.cachedValue]),null},l=function(){var t=e.useContext(a);if(void 0===t)throw new Error("Are you trying to use Reusable without a ReusableProvider?");return t},b=function(){var t=l(),r=e.useState(function(){return t.getUnitsArray()}),u=r[0],i=r[1];return e.useEffect(function(){return t.onUnitsChanged(function(){i(t.getUnitsArray())})},[]),n.createElement(n.Fragment,null,u.map(function(t,e){return n.createElement(h,{key:e,unit:t})}))},p=function(t){return t};t.createStore=function(){return new u},t.getStore=o,t.replaceStore=function(t){return i=t},t.ReusableProvider=function(t){var e=t.children;return n.createElement(a.Provider,{value:o()},n.createElement(n.Fragment,null,n.createElement(b,null),e))},t.reusable=function(t){return o().createUnit(t),function(n,r){return function(t,n,r){void 0===n&&(n=p),void 0===r&&(r=f);var u=l().getUnit(t),i=e.useState(function(){return n(u.getValue())}),o=i[0],s=i[1];return e.useEffect(function(){return u.subscribe(function(t){var e=n(t);r(e,o)||s(function(){return e})})},[u,o,n,r]),o}(t,n,r)}}});
//# sourceMappingURL=reusable.umd.js.map
