import t,{useState as n,useContext as r,useEffect as e}from"react";var i=function(t){this.subscribers=[],this.cachedValue=null,this.fn=t};i.prototype.getValue=function(){return this.cachedValue},i.prototype.run=function(){return this.cachedValue=this.fn(),this.cachedValue},i.prototype.subscribe=function(t){var n=this;return this.subscribers=this.subscribers.concat([t]),function(){n.subscribers=n.subscribers.filter(function(n){return n!==t})}},i.prototype.notify=function(){var t=this;this.subscribers.forEach(function(n){return n(t.cachedValue)})};var u=function(){this.units=new Map,this.subscribers=[]};u.prototype.onUnitsChanged=function(t){var n=this;return this.subscribers=this.subscribers.concat([t]),function(){return n.subscribers=n.subscribers.filter(function(n){return n!==t})}},u.prototype.createUnit=function(t){if(this.units.has(t))throw new Error("Unit already exist",t);var n=new i(t);this.units.set(t,n),this.notifyUnitsChanged()},u.prototype.getUnit=function(t){if(!this.units.has(t))throw new Error("Unit doesn't exist",t);return this.units.get(t)},u.prototype.notifyUnitsChanged=function(){this.subscribers.forEach(function(t){return t()})},u.prototype.getUnitsArray=function(){var t=[];return this.units.forEach(function(n){t.push(n)}),t};var o=function(){return new u},s=new u,c=function(){return s},a=function(t){return s=t},f=Object.prototype.hasOwnProperty;function h(t,n){return t===n?0!==t||0!==n||1/t==1/n:t!=t&&n!=n}function l(t,n){if(h(t,n))return!0;if("object"!=typeof t||null===t||"object"!=typeof n||null===n)return!1;var r=Object.keys(t),e=Object.keys(n);if(r.length!==e.length)return!1;for(var i=0;i<r.length;i++)if(!f.call(n,r[i])||!h(t[r[i]],n[r[i]]))return!1;return!0}var b=t.createContext(),p=function(n){var r=n.children;return t.createElement(b.Provider,{value:c()},t.createElement(t.Fragment,null,t.createElement(d,null),r))},y=function(t){var n=t.unit;return n.run(),e(function(){return n.notify()},[n.cachedValue]),null},v=function(){var t=r(b);if(void 0===t)throw new Error("Are you trying to use Reusable without a ReusableProvider?");return t},d=function(){var r=v(),i=n(function(){return r.getUnitsArray()}),u=i[0],o=i[1];return e(function(){return r.onUnitsChanged(function(){o(r.getUnitsArray())})},[]),t.createElement(t.Fragment,null,u.map(function(n,r){return t.createElement(y,{key:r,unit:n})}))},g=function(t){return t},U=function(t){return c().createUnit(t),function(r,i){return function(t,r,i){void 0===r&&(r=g),void 0===i&&(i=l);var u=v().getUnit(t),o=n(function(){return r(u.getValue())}),s=o[0],c=o[1];return e(function(){return u.subscribe(function(t){var n=r(t);i(n,s)||c(function(){return n})})},[u,s,r,i]),s}(t,r,i)}};export{o as createStore,c as getStore,a as replaceStore,p as ReusableProvider,U as reusable};
//# sourceMappingURL=reusable.mjs.map
